<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body oncontextmenu="return false;" onselectstart="return false">
        <div class="main-div">
            <input type="button" value="福" name="" id="roll" onclick="panalController.mouseclick.rollClick()" onmouseover="panalController.mouseOver.rollOver()" onmouseout="panalController.mouseOut.rollOut()">
            <div id="resultDiv">
                <table id='resultTable'>
                    <tbody id='resultTbody'>
                    </tbody>
                </table>
            </div>
            <a id="githuburl" href="https://github.com/MEorpheus">GitHub</a>
        </div>
        <script>
            window.onload=function(){
                /* Method of Object*/
                Object.prototype.clone = function () {
                    var Constructor = this.constructor;
                    var obj = new Constructor();

                    for (var attr in this) {
                        if (this.hasOwnProperty(attr)) {
                            if (typeof(this[attr]) !== "function") {
                                if (this[attr] === null) {
                                    obj[attr] = null;
                                }
                                else {
                                    obj[attr] = this[attr].clone();
                                }
                            }
                        }
                    }
                    return obj;
                };
                /* Method of Array*/
                Array.prototype.clone = function () {
                    var thisArr = this.valueOf();
                    var newArr = [];
                    for (var i=0; i<thisArr.length; i++) {
                        newArr.push(thisArr[i].clone());
                    }
                    return newArr;
                };
                Array.prototype.deduplication = function () {
                    var thisArr = this.valueOf();
                    for (var i=0; i<thisArr.length; i++) {
                        for (var j=0; j<thisArr.length; j++) {
                            if(thisArr[i]===thisArr[j]&&i!==j)
                                thisArr.splice(j,1);
                        }
                    }
                };

                /* Method of Boolean, Number, String*/
                Boolean.prototype.clone = function() { return this.valueOf(); };
                Number.prototype.clone = function() { return this.valueOf(); };
                String.prototype.clone = function() { return this.valueOf(); };

                /* Method of Date*/
                Date.prototype.clone = function() { return new Date(this.valueOf()); };

                /* Method of RegExp*/
                RegExp.prototype.clone = function() {
                    var pattern = this.valueOf();
                    var flags = '';
                    flags += pattern.global ? 'g' : '';
                    flags += pattern.ignoreCase ? 'i' : '';
                    flags += pattern.multiline ? 'm' : '';
                    return new RegExp(pattern.source, flags);
                };
                Function.prototype.bind();
                if(window.screen.width<1023){
                    document.addEventListener('touchstart',function(e){
                        var obj;
                        if(!event) event = window.event;
                        if(event.target) obj = event.target;
                        else if(event.srcElement) obj = event.srcElement;
                        if (obj.nodeType == 3) obj = obj.parentNode;
                        console.log(obj);
                        var ev = e||event;
                        if(obj.id==='roll'){
                            panalController.mouseOver.rollOver();
                            window.setTimeout(function(){panalController.mouseOut.rollOut();},300);
                        }
                    });
                }
                document.getElementsByClassName('main-div')[0].setAttribute('style','height:' + window.screen.height + 'px;width:' + window.screen.width + 'px;');
                panalController.init();
            }

            var data = {
                words:[
                    "恭喜发财",
                    "岁岁平安",
                    "心想事成",
                    "吉祥如意",
                    "招财进宝",
                    "金玉满堂",
                    "阖家幸福",
                    "步步高升",
                    "吉星高照",
                    "一帆风顺",
                    "十全十美",
                    "四季平安",
                    "万事胜意",
                    "飞黄腾达",
                    "前程似锦",
                    "财运亨通",
                    "意气风发",
                    "好事连连",
                    "笑口常开",
                    "大吉大利",
                ],
                getWordsList:function(count){
                    return data.getRoundList(count,data.words)
                },
                getRoundList:function(count,array){
                    cparray = array.clone();
                    result = [];
                    for (i = 0; i<count; i++){
                        var index =  Math.round(Math.random()*(cparray.length-1));
                        result.push(cparray[index]);
                        cparray.splice(index,1);
                    }
                    return result
                },
                getContent:function(){
                    return "霏霏祝您：<br>" + data.getWordsList(2).toString().replace(",","，");
                }
            }

            var panalController = {
                init:function(){
                    var titles = document.getElementsByName("title");
                    maxHeight  = 0;

                    titles.forEach(function(item){
                        if(item.parentNode.offsetHeight>maxHeight){
                            maxHeight = item.parentNode.offsetHeight + 1;
                        }
                    },this);
                    document.getElementById('resultDiv').style.cssText="height:" + (maxHeight).toString() + "px;";
                },
                addClass:function(obj, cls){
                    var obj_class = obj.className,
                        blank = (obj_class != '') ? ' ' : '';
                    added = obj_class + blank + cls;
                    obj.className = added;
                },
                removeClass:function(obj, cls){
                    var obj_class = ' '+ obj.className +' ';
                    obj_class = obj_class.replace(/(\s+)/gi, ' '),
                        removed = obj_class.replace(' '+cls+' ', ' ');
                    removed = removed.replace(/(^\s+)|(\s+$)/g, '');
                    obj.className = removed;
                },
                hasClass:function(obj, cls){
                    var obj_class = obj.className,
                        obj_class_lst = obj_class.split(/\s+/);
                    x = 0;
                    for(x in obj_class_lst) {
                        if(obj_class_lst[x] == cls) {
                            return true;
                        }
                    }
                    return false;
                },
                setObjHeight(obj){
                    obj.style.cssText = "height:" + (obj.offsetHeight * 1.6).toString() + "px;";
                },
                setObjZoreHeight(obj){
                    panalController.setObjHeight(obj);
                    panalController.addClass(obj,'zeroHeight');
                },
                unsetObjZoreHeight(obj){
                    panalController.addClass(obj,'transDiv');
                    document.getElementById('resultDiv').className = 'heightAuto';
                    panalController.removeClass(obj,'zeroHeight');
                },
                heightTrans(obj){
                    panalController.setObjZoreHeight(obj);
                    window.setTimeout(panalController.unsetObjZoreHeight.bind(null,obj),1);
                },
                hiddenResult(){
                    var tableEles = document.getElementsByClassName('tableEle');
                    for(index in tableEles){
                        panalController.addClass(tableEles[index],'zeroHeight');
                    }
                },
                showResult(){
                    var tableEles = document.getElementsByClassName('tableEle');
                    for(index in tableEles){
                        panalController.removeClass(tableEles[index],'zeroHeight');
                    }
                },
                cleanResult(){
                    document.getElementById('resultTbody').innerHTML = '';
                },
                addResult(){
                    var tr = document.createElement("tr");
                    var td = document.createElement("td");
                    div = document.createElement("div");
                    panalController.addClass(div,'tableEle');
                    div.innerHTML = data.getContent();
                    td.appendChild(div);
                    tr.appendChild(td);
                    panalController.removeClass(document.getElementById('resultDiv'),'heightAuto')
                    document.getElementById('resultTbody').appendChild(tr);
                    window.setTimeout(panalController.heightTrans.bind(null,div),1);
                },

                roll:function(){

                    if(document.getElementsByTagName('tr').length>0){
                        panalController.hiddenResult()
                        if(window.screen.width<=1025)
                            window.setTimeout(function(){panalController.cleanResult();
                            panalController.addResult();},299);
                        else
                            window.setTimeout(function(){panalController.cleanResult();
                            panalController.addResult();},399);
                    }
                    else{
                        if(window.screen.width<=1025)
                            window.setTimeout(function(){panalController.cleanResult();
                            panalController.addResult();},1);
                        else
                            window.setTimeout(function(){panalController.cleanResult();
                            panalController.addResult();},1);
                    }
                },
                mouseclick:{
                    rollClick:function(){
                        panalController.roll();
                    },
                },

                mouseOver:{
                    rollOver:function(){
                        if(!document.getElementById('roll').classList.contains('rollOver'))
                            panalController.addClass(document.getElementById('roll'),'rollOver');
                    }
                },
                mouseOut:{
                    rollOut:function(){
                        panalController.removeClass(document.getElementById('roll'),'rollOver');
                    }
                }
            }
            var reduceFun = function(coll,item){
                    coll.push( item );
                    return coll;
            }
        </script>
        <style>
            select::-ms-expand { display: none; }
            *{
                margin: 0px;
                padding: 0px;
            }
            body{
                background-color: #ff2121;
                text-align:center
            }
            .main-div{
                background-color: #ff2121;
            }
            .zeroHeight{
                height: 0px !important;
                margin-top: 0px !important;
                margin-bottom: 0px !important;
            }
            .heightAuto{
                height: auto !important;
            }
            #resultTable{
                margin-left: 10%;
                border-spacing: 0;
                border-collapse:collapse;
                table-layout: fixed;
                width: 80%;
            }
            #resultTable>tbody>tr{
                width: 100%;
            }
            #resultTable>tbody>tr>td{
                width: 25%;
                text-align: center;
                vertical-align:middle;
                display:table-cell; 
            }
            #resultTable>tbody>tr>td>div{
                margin-top: 2%;
                margin-bottom: 8%;
                overflow: hidden;
            }
            .buttonOver{
                -webkit-box-shadow: 3px 3px 3px rgba(0,0,0,.4);  
                -moz-box-shadow: 3px 3px 3px rgba(0,0,0,.4);  
                box-shadow: 3px 3px 3px rgba(0,0,0,.4);
            }
            #githuburl{
                color: #fff143;
                text-decoration: none;
            }
            @media only screen and (min-width: 1025px){
                input[type=button] {
                    cursor: pointer;
                    -moz-appearance:button; /* Firefox */
                    -webkit-appearance:button; /* Safari 和 Chrome */
                    border-radius: 0;
                }
                .count-count{
                    margin-left: 33%;
                    width: 34%;
                    background-color: #fff143;
                }
                .count-count>div{
                    display:inline-block !important;
                    width: 39%;
                }
                .count-count>div>div{
                    margin-top: 10%;
                    margin-bottom: 10%;
                }
                .count-count>div>div>span{
                    color: #ff2121;
                }
                .count-count>div>div>select{
                    padding-left: 1%;
                    cursor: pointer;
                    text-align: center;  
                    -moz-appearance:select; /* Firefox */
                    -webkit-appearance:select; /* Safari 和 Chrome */
                    display:inline;
                    width: 50%;
                    height: 1%;
                    border: solid 1px #ff2121;
                    border-radius: 0;
                    color: #ff2121;
                    appearance:none;
                    -moz-appearance:none;
                    -webkit-appearance:none;
                    padding-right: 14px;
                    outline:none;
                }
                .count-count>div>div>select>option{
                    cursor: pointer;
                    text-align: center;  
                    -moz-appearance:option; /* Firefox */
                    -webkit-appearance:option; /* Safari 和 Chrome */
                    width: 20%;
                    height: 1%;
                    border: solid 1px #ff2121;
                    color: #ff2121;
                    appearance:none;
                    -moz-appearance:none;
                    -webkit-appearance:none;
                    padding-right: 14px;
                    outline:none;
                }
                #roll{
                    margin-bottom: -1px;
                    margin-top: 2%;
                    width: 34%;
                    height: 10%;
                    border: 0;
                    outline:none;
                    font-size:400%;
                    background-color: #fff143;
                    color: #ff2121;
                    -webkit-transform: translateX(0);
                    -moz-transform: translateX(0);
                    -ms-transform: translateX(0);
                    -o-transform: translateX(0);
                    transform: translateX(0);
                    -webkit-transition: -webkit-margin 0.4s,-webkit-height 0.4s,-webkit-width 0.4s,-webkit-transform 0.4s;
                    -moz-transition: -moz-margin 0.4s,-moz-height 0.4s,-moz-width 0.4s,-moz-transform 0.4s;
                    transition: margin 0.4s,height 0.4s,width 0.4s,transform 0.4s;
                    will-change: margin,height,width,transform;
                    filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2); /* IE6,IE7 */
                    ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)"; /* IE8 */
                    -moz-transform: rotate(-180deg); /* 火狐3.5+ */
                    -o-transform: rotate(-180deg); /* Opera 10.5 */
                    -webkit-transform: rotate(-180deg); /* Safari 3.1+, Chrome */
                }
                .rollOver{
                    /* width: 16% !important; */
                    height: 12% !important;
                }
                #resultDiv{
                    margin-left: 33%;
                    width: 34%;
                    background-color: #fff143;
                    color: #ff2121;
                    overflow: hidden;
                }

                #resultTable>tbody>tr>td>div.transDiv{
                    -webkit-transform: translateX(0);
                    -moz-transform: translateX(0);
                    -ms-transform: translateX(0);
                    -o-transform: translateX(0);
                    transform: translateX(0);
                    -webkit-transition: -webkit-margin 0.4s,-webkit-height 0.4s,-webkit-width 0.4s,-webkit-transform 0.4s;
                    -moz-transition: -moz-margin 0.4s,-moz-height 0.4s,-moz-width 0.4s,-moz-transform 0.4s;
                    transition: margin 0.4s,height 0.4s,width 0.4s,transform 0.4s;
                    will-change: margin,height,width,transform;
                    font-size: 150%;
                }
                #materials{
                    background-color: #fff143;
                    width:34%;
                    margin-left:33%;
                    color:#ff2121;
                    padding-top: 1%;
                }
                #materials>div{
                    margin-left: 10%;
                    width: 80%;
                }
            }
            @media only screen and (min-width: 240px) and (max-width: 1024px){
                input[type=button] {
                    cursor: pointer;
                    -moz-appearance:none; /* Firefox */
                    -webkit-appearance:none; /* Safari 和 Chrome */
                    border-radius: 0;
                }
                .count-count{
                    margin-left: 3%;
                    width: 94%;
                    background-color: #fff143;
                }
                .count-count>div{
                    display:inline-block !important;
                    width: 39%;
                }
                .count-count>div>div{
                    margin-top: 10%;
                    margin-bottom: 10%;
                    font-size: 100%;
                }
                .count-count>div>div>span{
                    color: #ff2121;
                }
                .count-count>div>div>select{
                    padding-left: 1%;
                    cursor: pointer;
                    text-align: center;  
                    -moz-appearance:select; /* Firefox */
                    -webkit-appearance:select; /* Safari 和 Chrome */
                    display:inline;
                    width: auto;
                    border: solid 1px #ff2121;
                    color: #ff2121;
                    border-radius: 0;
                    appearance:none;
                    -moz-appearance:none;
                    -webkit-appearance:none;
                    padding-right: 14px;
                    outline:none;
                    font-size: 100%;
                }
                .count-count>div>div>select>option{
                    cursor: pointer;
                    text-align: center;  
                    -moz-appearance:option; /* Firefox */
                    -webkit-appearance:option; /* Safari 和 Chrome */
                    width: 20%;
                    height: 1%;
                    border: solid 1px #ff2121;
                    color: #ff2121;
                    appearance:none;
                    -moz-appearance:none;
                    -webkit-appearance:none;
                    padding-right: 14px;
                    outline:none;
                    font-size: 100%;
                }
                #roll{
                    margin-bottom: -1px;
                    margin-top: 3%;
                    width: 94%;
                    height: 62%;
                    border: 0;
                    outline:none;
                    font-size:1200%;
                    background-color: #fff143;
                    color: #ff2121;
                    -webkit-transform: translateX(0);
                    -moz-transform: translateX(0);
                    -ms-transform: translateX(0);
                    -o-transform: translateX(0);
                    transform: translateX(0);
                    -webkit-transition: -webkit-margin 0.3s,-webkit-height 0.3s,-webkit-width 0.3s,-webkit-transform 0.3s;
                    -moz-transition: -moz-margin 0.3s,-moz-height 0.3s,-moz-width 0.3s,-moz-transform 0.3s;
                    transition: margin 0.3s,height 0.3s,width 0.3s,transform 0.3s;
                    will-change: margin,height,width,transform;
                    filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2); /* IE6,IE7 */
                    ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)"; /* IE8 */
                    -moz-transform: rotate(-180deg); /* 火狐3.5+ */
                    -o-transform: rotate(-180deg); /* Opera 10.5 */
                    -webkit-transform: rotate(-180deg); /* Safari 3.1+, Chrome */
                    -webkit-tap-highlight-color: rgba(0,0,0,0);  
                }
                .rollOver{
                    /* width: 16% !important; */
                    height: 63% !important;
                }
                #resultDiv{
                    margin-left: 3%;
                    width: 94%;
                    background-color: #fff143;
                    color: #ff2121;
                    font-size: 100%;
                    overflow: hidden;
                }
                #resultTable>tbody>tr>td>div.transDiv{
                    -webkit-transform: translateX(0);
                    -moz-transform: translateX(0);
                    -ms-transform: translateX(0);
                    -o-transform: translateX(0);
                    transform: translateX(0);
                    -webkit-transition: -webkit-margin 0.3s,-webkit-height 0.3s,-webkit-width 0.3s,-webkit-transform 0.3s;
                    -moz-transition: -moz-margin 0.3s,-moz-height 0.3s,-moz-width 0.3s,-moz-transform 0.3s;
                    transition: margin 0.3s,height 0.3s,width 0.3s,transform 0.3s;
                    will-change: margin,height,width,transform;
                    font-size: 160%;
                }
                #materials{
                    background-color: #fff143;
                    font-size: 100%;
                    width:94%;
                    margin-left:3%;
                    color:#ff2121;
                    padding-top: 1%;
                }
                #materials>div{
                    margin-left: 10%;
                    width: 80%;
                }
            }
        </style>
    </body>
</html>
